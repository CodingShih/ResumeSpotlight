第一章、緒論 
1.1  研究動機 
    人工智慧( Artificial Intelligence, AI )又稱機器智慧，指由人工製
造出來的系統所表現出來的智慧。人工智慧讓電腦具有學習、推理
及判斷解決問題之能力。簡而言之，人工智慧是使電腦具備聰明特
性，並使人類生活更加便利之工具。人工智慧用於機器視覺、自然
語言處理及其他各項領域都有很好的發展，為近代資料處理的重要
方法。 
1.2  人工智慧歷史回顧[1-2] 
    現代的人工智慧理論應該要從二十世紀初期的計算學開始，代
表人物包含哥德爾( Kurt Gödel )與圖靈( Alan Turing )。當時計算學
家所設計出的「智慧」理論，實際上是用於量化系統化工作。以圖
靈設計的圖靈機器( Turing Machine  ，自動化機器的一種  )為例，其
理論靈感來自於工業生產線，並且以在捆捆紙帶上打洞來進行自動
化計算工作。對於二十世紀初的計算學家而言，「人工智慧」只是
一種能夠將計算工作自動化的理論，並沒有跟人類的各種智慧面向
1 
作深度的理論連結。 
    在  1960  年代以前，人們討論的人工智慧只是今日的資訊科
學，而  1970  年代開始，一些學者與業界人士開始利用認知心理學
的知識模型與邏輯學來設計所謂的專家系統，這類系統講究資料之
間與概念之間的關係，讓機器可以進行人類一般的深層語義推理。
到了  1990  年代，許多人工智慧學者和業界人士發現傳統人工智慧
的系統太過於複雜且無法容許誤差，無法用來設計實用的大型商用
系統。因此，往後，越來越多學者與業界人士開始投入利用統計學
模型來模擬人類決策的機器學習。 
    現今被人稱作「人工智慧」的機器學習，跟傳統資料處理的方
法有很大的差異。首先，機器學習方法需要大量的資料；其次，這
些資料的採集、篩選以及處理，都仰賴良好的變數選擇；第三，機
器學習方法的輸入以及輸出結果之間的關係是建立於統計關係，而
非邏輯與語義關係；第四，機器學習方法之結果之意義來自於設計
者賦予的意義，而非模型結構本身。而現今常常被討論的「深度學
習」( Deep Learning )，就是實現機器學習的一種方法。基本上深度
學習的理論基礎就是「人工神經網路」，用許多可以處理輸入的資
訊處理單位來組成網路，然後再用多層網路來做出理想的統計分
2 
布。以上所述之人工智慧、機械學習以及深度學習，以同心圓來描
述，最能說明三者之間的關係，其關係如下圖 1.1 所示。其中最 早
出 現 的 人 工 智 慧 是 最 大 那 個 圓 ， 接 著 是 後 來 出 現 的 機 器 學
習 ， 最 後 是 推 動 目 前 人 工 智 慧 領 域 出 現 爆 炸 性 發 展 的 深 度 學
習 ， 則 是 落 在 最 內 部 的 圓 。  
圖 1.1.  人工智慧、機械學習以及深度學習關係圖. 
    人工智慧的應用領域非常廣泛，近年來人們常使用的個人語音助
理(如蘋果 Siri  、微軟 Cortana )，以及擊敗人類西洋棋與圍棋高手的
IBM Deep Blue、 Google DeepMind AlphaGo  都是人工智慧研究的產
物。隨著研發技術的飛速進展，人工智慧深入人類醫療、金融等人類
日常生活的日子指日可待。 
3 
1.3  人工智慧應用於雨量預測與測謊 
        本研究將實現人工智慧於日常生活中應用，在本論文中將分別討
論兩項使用人工智慧之應用。第一項應用是將人工智慧應用於雨量預
測，由於雨量是評估水資源、農業、生態系統、水庫發電、用電、土
石流防災及水文的重要依據，而降雨的機制在數學角度而言是屬於非
線性系統，而近年來所提出的模糊理論、類神經網路等人工智慧模式
對於處理非線性系統有相當不錯的效果，基於人工智慧模式對於處理
非線性系統強大的效能，因此本研究使用人工智慧理論開發一個降雨
之預測模式，以台南曾文氣象觀測站為對象，使用  ESN  之演算法，
提出一個可以達到雨量預測效果之方式。 
    第二項應用則是將人工智慧用於測謊，由於目前測謊之儀器主
要是透過生理訊號的觀測來進行說謊之判斷，如測謊儀、眼動儀、
腦波儀等，而最為普遍的是測謊儀。測謊儀大部分是透過藉由觀測
受試者之皮膚電阻、呼吸波與脈搏波(血壓)為主要參數來量測人們
的心理變化來測量人們的心理變化，但其準確度常依賴於測試人員
的測試經驗以及技巧，因此本研究決定使用人工智慧理論開發一個
判斷測謊之模式，利用語音資訊配合  ESN  之演算法，提出一個可
4 
以達到測謊效果之方式。 
1.4  結論 
    由於人工智慧具有使電腦具備聰明特性，為人類生活更加便利
之工具。並且於機器視覺、自然語言處理及其他各項領域都有很好
的發展，因此本研究致力於發展人工智慧對於人類生活之應用。在
本研究中，我們將討論人工智慧於雨量預測以及於測謊之應用。 
5 
第二章、Reservoir Computing 
    要介紹  Reservoir Computing( RC )，必須先由遞迴神經網路
( Recurrent Neural Networks , RNN )講起。所謂的 RNN ，是一種把
輸出端再接回輸入端的類神經網路，這樣可以把上個時間點的輸出
值再傳回來，記錄在神經元中，使得下個時間點的輸出值，跟上個
時間點有關，也就是說，這樣的神經網路是有記憶性的。其基本架
構如下圖 2.1.。其中  Xt  是輸入資料，  Yt  是目標輸出答案，  nin,t 
為輸入神經元 n 的值，  Wc  是給目前的時間點輸入值  xt  的權重， 
Wp  是給上個時間點時輸出值  nout,t-1  的權重，而  b  為偏權值。 
圖 2.1.  由一個神經元所構成的  RNN  架構. 
6 
    RNN  因其遞迴處理歷史資料和具有記憶性功能的特點而特別適
用於處理與時間、空間序列上有關聯的資料。儘管  RNN  在學術和
實際應用上已達成許多的成就，但  RNN  在非線性建模中長期以來
一直受限。其主要原因在於內部節點間互相作用之複雜性。為了避
免這個問題，科學家們提出了  Backpropagation-Decorrelation 
( BPDC )學習規則、  Liquid State Machine ( LSM )本研究所使用的 
Echo State Networks ( ESN )  ，以上三種方式被統稱為  Reservoir 
Computing。[3] 
    RC  的共同思想是將輸入信號送到固定的動態系統，將此系統
稱為 Reservoir  。  Reservoir  是由隨機產生的遞迴連接，而連接通常
保持固定不變。藉由輸入資料的改變，  Reservoir  能夠改變權重以
達到期望的輸出。 
    RC  計算方法因以下幾個優點而迅速發展，分別是建模的精密
度、建模的能力、生物似然性、可擴展性。  Laurent Larger 等[4]更
將  RC  應用高速光子系統之計算，證明  RC  可以於光學電腦中進
行運算，因此其發展性更是不言而喻。 
    因本論文使用之架構為  Echo State Network ( ESN )模型，因此
以下特別介紹  ESN  。 
7 
2.1 Echo State Network [5-10] 
      2001 年，  Wolfgang Maass  以  Liquid State Machines  為名義和
Herbert Jaeger 以  Echo State Networks  為名義，提出了 RNN  設計和
訓練的新方法。  ESN  以大量的隱藏層作為其 Reservoir (大約  50 
到  1000  個神經元，而其他技術通常使用  5  到 30  個神經元)進行
建模。傳統  RNN  方法調整所有的連接權重，包括輸入到  RNN  、 
RNN  內部和  RNN  到輸出權重都被調整，而在  ESN  中，只有在輸
出時權重才受到調整[10]。因此可以使用許多線性回歸算法進行訓
練，提高學習的表現。圖 2.2.表示  RNN  訓練方法與  RC  方法之比
較。 
             (a)                                 (b) 
圖 2.2.  傳統  RNN  訓練方法與  RC  方法之比較.(a)傳統  RNN  方法所有連
接權重（粗體箭頭），包括輸入到  RNN  、  RNN  內部和  RNN  到輸出權 
  重都被調整. (b)在  RC  中，只有輸出時權重才受到調整.[3] 
8 
    這個機制使得 ESN  具有  RNN  之能力，且比起  RNN  有更快
的訓練速度。 
圖 2.3. ESN  之基礎架構 
    圖 2.3.為  ESN  之基礎架構，其中  Win  及  W  為輸入權重以及
遞迴權重，因為在  ESN 中只有輸出時權重才受到調整，因此  Win 
及  W  為固定，而其決定方法為透過亂數決定。  u(n)  是輸入信號， 
y(n)  是輸出信號，x(n)  為第 n  步時  Reservoir  的狀態向量，  x̃(n)
是其更新量。  x̃(n) 及  x(n)  之計算公式如式(2.1)及(2.2)[6]： 
𝑥̃(𝑛) =  𝑓( 𝑊𝑖𝑛[1; 𝑢(𝑛)] + 𝑊𝑥(𝑛 − 1))            (2.1) 
         x(n) = (1 − 𝛼)𝑥(𝑛 − 1) +  𝛼𝑥̃(𝑛)                (2.2)   
9 
    式(2.1)中之  f  表示活化函數，[ _; _ ]  表示垂直向量序連。 
f  為非線性函數，文獻大多採用  S  形函數(  例如  tanh )。而本研究
中使用之  f  函數為一混沌函數( chaos )，混沌函數是指關於非線性
系統在一定參數條件下展現分岔( bifurcation )、周期運動與非周期運
動相互糾纏，以至於通向某種非周期運動的函數。本研究所使用之 
chaos  函數如式(2.3)： 
𝑋𝑛+1 = 𝑎𝑋𝑛(1 − 𝑋𝑛)                        (2.3)  
若以  a = 0  到  a = 4  的範圍為例子，本研究使用之函數值如下圖
2.4.，從圖中可以看出其函數會以非週期的運動來回振盪。本論文所
使用的  a  值為  4  ，以產生在  0  與  1  之間的  Xn+1  輸出值。 
圖 2.4. chaos  函數值分布圖 
10 
    式(2.2)中之 𝜶  ∈ ( 0; 1 ] ，稱為  leaking rate  。𝜶 愈大代表
前期資料佔據之比重愈低，即與前期資料愈不相關，反之則與前期
資料愈相關。與當 𝜶 = 𝟏 時，𝒙̃(𝒏) ≡  𝒙(𝒏) ，此時  y(n) = Wout 
[1;u(n);x(n)]。蒐集由各個訓練訊號之 [1;u(n);x(n)] 向量至一  X  矩
陣內，並令一目標輸出值 ytarget(n)  至一矩陣  Ytarget  ，通過脊迴歸
( Ridge Regression )可計算出  Wout    矩陣，  Wout  之計算方式如下
式。 
𝑾𝒐𝒖𝒕 =   𝒀𝒕𝒂𝒓𝒈𝒆𝒕𝑿𝑻(𝑿𝑿𝑻 + 𝜸𝟐𝑰)−𝟏              (2.4) 
    其中  I  為單位矩陣， 𝜸  為正歸化矩陣。本研究所使用之 𝜶 
值為  0.4  ，而 Win 為一  10  × 8  之矩陣，W 為一  10  ×  10  之矩
陣。 
2.2  結論 
    在本章中概述了  ESN  的結構，其代數定義、工作原理以及優
勢所在。在文獻中， ESN  大多採用  S  形函數( 例如  tanh )。本研
究所使用的非線性函數為一混沌函數，在一定參數條件下展現分
岔、非周期運動相互糾纏，以至於通向某種非周期運動的函數，可
能有機會使資料的分類運算更加有效。在接下來的章節將會以  ESN 
為主要結構應用於雨量預測及測謊。 
11 
第三章、深度學習演算法應用於台南曾
文氣象站之雨量預測 
3.1  研究動機及文獻回顧 
    在第一次世界大戰後不久，英國氣象學家, Lewis Richardson  在
氣象學的名著 << Weather Prediction by Numerical Process >>  提出
[11]，既然大氣是按照物理法則而改變的，就可以用計算的方式預
測未來的天氣。不過，由於方程式十分複雜，所以計算過程極費
時，資料尚未計算完畢，鋒面就已經離開了。另外， Richardson  計
算時採用的資料，是每隔 6  小時取一次，但即使這樣，天氣預測還
不能完全準確。不過，電腦發展出來後，這些冗長的運算就可以在
短時間內完成了。氣象學家運用 Richardson  的計算方法，發展出一
個複雜的數值模式，也就是一連串的數學方程，把所有已知能影響
天氣的物理法則都包括在內。以此為根基，也發展出了現在預測天
氣的各項模式。[12] 
    雨量是評估水資源、農業、生態系統及水文的重要依據。吳宗
堯等人[13]指出雨量只要每小時大於 20  公厘，就會對作物造成損
12 
害。申雍等人[14]也在研究中指出，降雨累積雨量達  150  公厘以
上，也可能對大部分作物的生長造成損害。而台灣地處為熱帶及亞
熱帶季風氣候，四面環海且地形海拔變化大，常受劇烈天氣系統引
發的強降雨而造成重大災害。因此在天氣預測中如何準確地預測降
雨，在台灣是個很重要的議題。近年來許多學者都致力於改善對災
害天氣的監測和預報，及發展定量降水預報( Quantitative 
Precipitation Forecast, QPF )之技術，來改善對強降雨事件預報的能
力。在現今預測雨量的工具中，多為使用衛星影像、地面觀測站以
及探空氣球。另也有雷達影像技術[15]，但因影像資料量大，尚未
大規模應用。中央氣象局現有預測雨量的做法則是依國際標準，一
天放  2  次探空氣球，再加上地面氣象測站及衛星資料，以十二小時
為單位做雨量預測(定量降水預報)。 
    現今雨量的預測大致上可分為短期預測、中期預測以及長期預
測，一般而言，預測未來一到三天內的預測，稱為「短期預測」；
預測未來一星期左右的預測，稱為「中期預測」；預測未來更長時
期，甚至一年的預測，稱為「長期預測」。吳明進[16]利用月平均
溫度與降雨資料，解釋台灣彭佳嶼長期的降雨變化，他發現長時間
變化較短時間變化來的複雜，每年的變化也較大。而本文則是針對
13 
短期雨量預測之研究。 
    由於降雨的機制在數學角度而言是屬於非線性系統，而近年來
所提出的模糊理論、類神經網路等人工智慧模式[17-32]對於處理非
線性系統有相當不錯的效果，於水文流量及雨量預測中也有不錯的
發展。如  Nayak  等人[19]以模糊理論即時預測印度曼達拉流域河川
出流量；段智懷[21]比較人工神經網路中的前饋式網路( Feedforward 
Neural Network, FNN )與遞迴式類神經網路(RNN )於小區域颱風降雨
預報的效果，結果顯示  RNN  具有較佳的預測效率；  Reinhard 
Teschl  等人[22]以前饋式類神經網路改善天氣雷達之預估。 
    基於人工智慧模式對於處理非線性系統強大的效能，因此本研
究使用人工智慧理論開發一個降雨之預測模式，以台南曾文觀測站
為對象，使用  ESN  之演算法，提出一個可以達到雨量預測效果之
方式。 
3.2  資料蒐集 
    本研究之研究資料來自於中央氣象局以及夏威夷大學海平面中
心( Sea Level Center, University of Hawaii )，由於硬體設備及人為等
外在變因，各地氣象站的資料有資料缺漏或錯誤的情形，我們經過
14 
審慎的評估後，決定採用台南曾文觀測站(120.497E,23.219N)之資料
配合夏威夷大學海平面中心取得之高雄潮位站(120.283E, 22.617N)之
水位資料，其原因為該觀測站之資料較為完整。本實驗取自  2002 
年至  2014  年每小時的觀測資料，共含有氣壓、氣溫、濕度、風
速、風向、水位、雨量，總共七項參數。剔除有缺漏或錯誤情形之
資料後，共有  102500  小時之資料，取其作為本實驗模型建構之依
據。 
3.3  資料預處理 
    一般而言，在深度學習的領域中都會對數據進行預處理，而歸
一化為最常使用的方式。因為資料中不同的參數會有不同量度單位
及精準度，而這些會影響數據分析的結果。為了消除這些參數間量
度單位及精準度之影響，需要將資料做標準化的處理，增加資料之
間的可比性。而歸一化的作用是將資料統一樣本的分布性，將事件
的統計分布統一歸納，並且可以有效地加快模型之訓練速度。 
    常見的歸一化方法有兩種，第一種稱為  Z-score  標準化法，這
種方法給原始數據之平均值和標準差進行數據的標準化。經過處理
的數據符合標準常態分佈，意即平均值為  0  ，標準差為  1  。此種
15 
方式在分類、聚類分析中，需要以距離來衡量相似性中之效果較
好。其轉化公式如式(3.1)： 
                    𝑋∗ =
𝑋−𝑋
𝜎
                           (3.1) 
其中𝑋為所有樣本數據的平均值，𝜎為樣本數據的標準差。 
    第二種方法稱為  min-max  標準化( min-max normalization ) 也
稱為離差標準化，是對原始數據進行線性變化，轉化公式如下：               
                     𝑋∗ =
X−min
𝑚𝑎𝑥−𝑚𝑖𝑛
                     (3.2) 
其中 𝑋∗ 為標準化後之結果， max  為樣本數據中的最大值，  min 
為樣本數據中的最小值。此方法有個缺陷，就是當新數據加入時，
可能導致最大值或最小值有所變化，需要重新定義。 
    而在神經網路中則有另一常用之標準化法，稱為  mapminmax 
標準化，該方法逐項對數據進行標準化處理，將每筆數據分別標準
化至區間內，其計算公式如下： 
  y =
(𝑦𝑚𝑎𝑥−𝑦𝑚𝑖𝑛)×(x−𝑥𝑚𝑖𝑛)
(𝑥𝑚𝑎𝑥−𝑥𝑚𝑖𝑛)
+ 𝑦𝑚𝑖𝑛                    (3.3) 
其中  ymax  為標準化後輸出資料之最大值，  ymin  為標準化後輸出資
料之最小值，  xmin  為樣本數據中的最小值。 
    由於本研究使用之各項氣象參數之數值較為集中，因此本研究
16 
使用之歸一化方法為  mapminmax  標準化，將數據的每一維度重新
調節，使其落在  -1  至  1  之區間。亦就是說， ymax  與  ymin  分別為 
1  與  -1  。 
3.4  實驗流程 
    本實驗使用  RC  中的  Echo state network ( ESN )為架構，利用
蒐集到之七項參數(分別為氣壓、氣溫、濕度、風速、風向、水位以
及雨量)，共  102500  個時間點之資料，將一部分之資料進行 
mapminmax  標準化做為  ESN  訓練之輸入資料，剩下之資料根據訓
練資料進行標準化之 mapminmax  標準化處理，做為  ESN  測試之
輸入資料，輸入資料的下個小時之降雨量做為輸出答案。其網路架
構如下圖3.1.所示。其中  u(n)  為網路之輸入資料，  Win  為一未經訓
練的權重層，  f  為 一 非線性函 數 ， Wout  為訓練後所得之權重， 
W  為連結水庫內部的權重矩陣， x(n)  為第 n  步時  Reservoir  的狀
態向量， y(n)  為網路之輸出答案。 
17 
