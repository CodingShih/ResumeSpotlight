圖 6 X 軸為顯示了實驗二的 MSE, RMSE, r2-score，Y 軸為其數值。
與圖 3 相比我們可以看到 RMSE 也有所提高，這同時也說明了其預測效
果下降。 
圖7. 實驗二 LSTM 神經網絡於測試集上測試之結果 
圖 7 為實驗二的預測結果圖。X 軸為測試集的日期時間
(2019/12/30~2020/12/31，以天數算) Y 軸為指數(用 Python 標準化處理的
數值)，紅色線為實際的加權股價報酬指數的走勢，黑色線為實驗二預測
的結果。我們也可以看到加權股價報酬指數預測的結果開始跟實際走勢
有了落差基本上沒有重疊的部分，但具體來說走勢都有預測到只是有些
偏差而已。 
23 
實驗三 LSTM Units 使用兩層，一層 128 個神經元、一層 64 個神經
元，於 146 回訓練時提前終止。 
圖8. 實驗三 LSTM 神經網絡之驗證集損失值及測試集損失值 
圖 8. X 軸是實驗三跑的回數，Y 軸為 loss 值，分別顯示了驗證集
(跟測試集的下降曲線。如圖 8 所示在本次的實驗結果中測試集在前 10
回的時候產生了較大的波動，直接從 0.00 飆升超過 0.05 才依序下降。 
圖9. 實驗三 LSTM 神經網絡之 MSE、RMSE、r2_score 
圖 9. X 軸為顯示了實驗三的 MSE, RMSE, r2-score，Y 軸為其數
值。我們可以發現和實驗二相比結果略有下降。 
24 
圖10.  實驗三 LSTM 神經網絡於測試集上測試之結果 
圖 10.為實驗三的預測結果圖。X 軸為測試集的日期時間
(2019/12/30~2020/12/31，以天數算) Y 軸為指數(用 Python 標準化處理的
數值)，紅色線為實際的加權股價報酬指數的走勢，黑色線為實驗三預測
的結果。就結果來說預測跟走勢還算接近，在第 150 天開始有些偏差。 
實驗四、LSTM Units 使用兩層，一層 64 個神經元、一層 32 個神經
元於 144 回訓練時提前終止。 
圖11.  實驗四 LSTM 神經網絡之驗證集損失值以及測試集
損失值 
25 
圖 11.為  X 軸是實驗四跑的回數，Y 軸為 loss 值，分別顯示了驗證
集跟測試集的下降曲線。圖 11 當中顯示了實驗四的驗證集跟測試集的
訓練與實驗三相似，都是在 10 回內的時候遇到波動，並且於第 40 回內
遇到二次波動。 
圖12.  實驗四 LSTM 神經網絡之 MSE、RMSE、r2_score 
圖 12. X 軸為顯示了實驗四的 MSE, RMSE, r2-score，Y 軸為其數值。其
中顯示了在 MSE,RSME 上面相對於實驗三來說都取得比較好的結果。 
圖13.  實驗四 LSTM 神經網絡於測試集上測試之結果 
圖 13.為實驗四的預測結果圖。X 軸為測試集的日期時間
(2019/12/30~2020/12/31，以天數算) Y 軸為指數(用 Python 標準化處理的
數值)，紅色線為實際的加權股價報酬指數的走勢，黑色線為實驗四預測
的結果。我們也可以看到圖 13 加權股價報酬指數的預測結果跟實際結
26 
果有所接近，和實驗三的圖 10 相比只有些許的落差。 
透過實驗一到四，我們可以整理出表 11 的結果。雖然一層 256 個
神經元、一層 128 個神經元的結果看起來相對較差，但實際上是最為接
近的結果。所以我們得知在一層 256 個神經元、一層 128 個神經元
LSTM 神經網絡於測試集上測試之效果上是相對較好的，因此我們採取
這個參數設定後，開始使用情感指數來看能否提高 LSTM 預測的精準
度。 
UNIT 
50/50   
表11.  原始 LSTM 實驗之 MSE、RMSE、R2_SCORE 結果 
MSE 
RMSE 
R2_SCORE 
0.001349778718
0.03673933476437779 
0.9097216591939787 
9290184 
256/128   
0.000615484258
0.02480895521711166 
0.9614322018705469 
9646518 
128/64   
0.001770433117
0.04207651503556216 
0.879541762284824 
5378886 
64/32   
0.001257539130
0.03546179818573541 
0.9221764795300192 
5658273 
實驗五、鋼鐵工業相關情感指數 
實驗五到實驗八開始本論文加入先前透過 snownlp 的得到的新聞情感指
數，來看預測的效果是否有所提升。實驗五是加入了鋼鐵工業相關情感
指數的特徵作為預測的特徵的實驗結果。 
27 
圖14.  實驗五 LSTM 神經網絡之訓練集損失值及測試集損
失值 
圖 14. X 軸是實驗四跑的回數，Y 軸為 loss 值，分別顯示了驗證集
跟測試集的下降曲線。其中我們可以看到驗證集跟測試集的在 20 回，
80 回，120 回的時候訓練波動開始不平穩。 
圖15.  實驗五 LSTM 神經網絡之 MSE、RMSE、r2_score 
圖 15. X 軸為顯示了實驗五的 MSE, RMSE, r2-score，Y 軸為其數值。 
28 
圖16.  實驗五 LSTM 神經網絡於驗證集上測試之結果 
圖 16.為實驗五的預測結果圖。X 軸為測試集的日期時間
(2019/12/30~2020/12/31，以天數算) Y 軸為指數(用 Python 標準化處理的
數值)，紅色線為實際的加權股價報酬指數的走勢，黑色線為實驗五預測
的結果。我們也可以看到圖 16 加權股價報酬指數的預測結果跟實際結
果有所接近。 
實驗六開始加入了橡膠新聞相關的情感指數到 LSTM 模型中做為特
徵的模型預測結果: 
實驗六、橡膠工業相關情感指數 
圖17.  實驗六 LSTM 神經網絡之訓練集損失值及測試集損
失值 
29 
圖 17.X 軸是實驗六跑的回數，Y 軸為 loss 值，分別顯示了驗證集
跟測試集的下降曲線。可以看的是從一開始測試集跟驗證集的波動幅度
就非常大，從前 10 回、20 回、40 到 60 回都出現了驗證跟測試集的大
幅波動。 
圖18.  實驗六 LSTM 神經網絡之 MSE、RMSE、r2_score 
圖 18. X 軸為顯示了實驗六的 MSE, RMSE, r2-score，Y 軸為其數
值。我們可以看 r2-score 的分數相當接近 1，這代表預測跟實際的結果
非常的接近。 
圖19.  實驗六 LSTM 神經網絡於驗證集上測試之結果 
圖 19 為實驗六的預測結果圖。X 軸為測試集的日期時間
(2019/12/30~2020/12/31，以天數算) Y 軸為指數(用 Python 標準化處理的
數值)，紅色線為實際的加權股價報酬指數的走勢，黑色線為實驗六預測
的結果。顯示了加入橡膠新聞相關的情感指數讓預測的指數跟實際的加
權股價報酬指數更吻合了。 
30 
實驗七加入了電子工業新聞相關的情感指數作為特徵加入模型中預測。   
實驗七、電子工業相關情感指數 
圖20.  實驗七 LSTM 神經網絡之訓練集損失值及測試集損
失值 
圖 20.X 軸是實驗七跑的回數，Y 軸為 loss 值，分別顯示了驗證集
跟測試集的下降曲線。可以看到在一開始 10 回就有大量波動，40 回，
60 回測試之後才逐漸平準。 
圖21.  實驗七 LSTM 神經網絡之 MSE、RMSE、r2_score 
圖 21. X 軸為顯示了實驗六的 MSE, RMSE, r2-score，Y 軸為其數值。 
31 
圖22.  實驗七 LSTM 神經網絡於驗證集上測試之結果 
圖 22 為實驗七的預測結果圖。X 軸為測試集的日期時間
(2019/12/30~2020/12/31，以天數算) Y 軸為指數(用 Python 標準化處理的
數值)，紅色線為實際的加權股價報酬指數的走勢，黑色線為實驗七預測
的結果。我們可以看到預測跟實際的結果已經非常接近了。 
實驗八是加入了金融相關新聞的情感指數的模型預測結果。 
圖23.  實驗八 LSTM 神經網絡之訓練集損失值及測試集損
失值 
圖 23 X 軸是實驗八跑的回數，Y 軸為 loss 值，分別顯示了驗證集
跟測試集的下降曲線。我們可以看到結果跟實驗七有些類似，都是在前
10 回驗證集跟測試集的結果突然飆高，並且在接下來的回數逐漸降低。 
32 
圖24.  實驗八 LSTM 神經網絡之 MSE、RMSE、r2_score 
圖 24. X 軸為顯示了實驗八的 MSE, RMSE, r2-score，Y 軸為其數
值。顯示結果相較於實驗七來說預測能力有些許的下降。 
圖25.  實驗八 LSTM 神經網絡於驗證集上測試之結果 
圖 25 為實驗八的預測結果圖。X 軸為測試集的日期時間
(2019/12/30~2020/12/31，以天數算) Y 軸為指數(用 Python 標準化處理的
數值)，紅色線為實際的加權股價報酬指數的走勢，黑色線為實驗八預測
的結果。如同和圖 24 的結論一樣，在預測的實際結果也有下降。 
33 
